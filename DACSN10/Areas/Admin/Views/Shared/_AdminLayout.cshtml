<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - Admin OnlineLearning</title>

    <!-- CSS Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.0/dist/lux/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.0/dist/sweetalert2.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.0/main.min.css" rel="stylesheet">

    <link href="~/css/admin-site.css" rel="stylesheet" />

    @RenderSection("Styles", required: false)
</head>
<body>
    <!-- Sidebar -->
    <nav class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <a href="/Admin/Admin/Dashboard" class="sidebar-logo">
                <i class="fas fa-graduation-cap"></i>
                <span>Admin Panel</span>
            </a>
        </div>

        <div class="sidebar-nav">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Courses">
                        <i class="fas fa-book-open"></i>
                        <span>Quản lý khóa học</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Categories">
                        <i class="fas fa-tags"></i>
                        <span>Danh mục khóa học</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Students">
                        <i class="fas fa-user-graduate"></i>
                        <span>Quản lý học viên</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Teachers">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Quản lý giảng viên</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Payments">
                        <i class="fas fa-credit-card"></i>
                        <span>Quản lý thanh toán</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Statistics">
                        <i class="fas fa-chart-line"></i>
                        <span>Thống kê</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Analytics">
                        <i class="fas fa-analytics"></i>
                        <span>Phân tích</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/SystemHealth">
                        <i class="fas fa-heartbeat"></i>
                        <span>Tình trạng hệ thống</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Settings">
                        <i class="fas fa-cog"></i>
                        <span>Cài đặt</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/Admin/Admin/Maintenance">
                        <i class="fas fa-tools"></i>
                        <span>Bảo trì</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="admin-main" id="adminMain">
        <!-- Top Bar -->
        <header class="admin-topbar">
            <div class="topbar-left">
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="topbar-title">@ViewData["Title"]</h1>
            </div>

            <div class="topbar-right">
                <button class="notification-btn" data-bs-toggle="dropdown">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><h6 class="dropdown-header">Thông báo</h6></li>
                    <li><a class="dropdown-item" href="#"><i class="fas fa-exclamation-circle text-warning me-2"></i>3 thanh toán chờ duyệt</a></li>
                    <li><a class="dropdown-item" href="#"><i class="fas fa-clock text-info me-2"></i>5 khóa học chờ phê duyệt</a></li>
                    <li><a class="dropdown-item" href="#"><i class="fas fa-user-plus text-success me-2"></i>2 giảng viên mới đăng ký</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item text-center" href="#">Xem tất cả</a></li>
                </ul>

                <div class="dropdown">
                    <button class="profile-btn" data-bs-toggle="dropdown">
                        <img src="https://ui-avatars.com/api/?name=Admin&background=3b82f6&color=fff&bold=true&size=40"
                             alt="Admin" class="profile-avatar">
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><h6 class="dropdown-header">Quản trị viên</h6></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>Hồ sơ</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Cài đặt</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/Identity/Account/Logout"><i class="fas fa-sign-out-alt me-2"></i>Đăng xuất</a></li>
                    </ul>
                </div>
            </div>
        </header>

        <!-- Breadcrumb -->
        <div class="admin-content">
            <nav class="admin-breadcrumb" aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/Admin/Admin/Dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
                    @RenderSection("Breadcrumb", required: false)
                </ol>
            </nav>

            <!-- Main Content -->
            @RenderBody()
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.0/dist/sweetalert2.all.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.0/main.min.js"></script>

    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            easing: 'ease-out-quart',
            once: true
        });

        // Toastr configuration
        toastr.options = {
            "closeButton": true,
            "progressBar": true,
            "positionClass": "toast-top-right",
            "timeOut": 3000
        };

        // Sidebar toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebar = document.getElementById('adminSidebar');
            const mainContent = document.getElementById('adminMain');

            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('collapsed');
                document.body.classList.toggle('sidebar-collapsed');

                // Store sidebar state
                localStorage.setItem('sidebarCollapsed', sidebar.classList.contains('collapsed'));
            });

            // Restore sidebar state
            const sidebarCollapsed = localStorage.getItem('sidebarCollapsed');
            if (sidebarCollapsed === 'true') {
                sidebar.classList.add('collapsed');
                document.body.classList.add('sidebar-collapsed');
            }

            // Active nav link
            const currentUrl = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link');

            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentUrl) {
                    link.classList.add('active');
                }
            });

            // Mobile sidebar toggle
            if (window.innerWidth <= 992) {
                sidebarToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('show');
                });

                // Close sidebar when clicking outside
                document.addEventListener('click', function(e) {
                    if (!sidebar.contains(e.target) && !sidebarToggle.contains(e.target)) {
                        sidebar.classList.remove('show');
                    }
                });
            }
        });

        // Global admin functions
        function showLoading() {
            Swal.fire({
                title: 'Đang xử lý...',
                html: '<div class="spinner"></div>',
                showConfirmButton: false,
                allowOutsideClick: false
            });
        }

        function hideLoading() {
            Swal.close();
        }

        function showSuccess(message) {
            toastr.success(message);
        }

        function showError(message) {
            toastr.error(message);
        }

        function showWarning(message) {
            toastr.warning(message);
        }

        function showInfo(message) {
            toastr.info(message);
        }

        function confirmDelete(title, text, callback) {
            Swal.fire({
                title: title || 'Xác nhận xóa?',
                text: text || 'Bạn có chắc chắn muốn xóa? Hành động này không thể hoàn tác!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#ef4444',
                cancelButtonColor: '#6b7280',
                confirmButtonText: 'Xóa',
                cancelButtonText: 'Hủy'
            }).then((result) => {
                if (result.isConfirmed && callback) {
                    callback();
                }
            });
        }

        // CSRF Token setup for AJAX
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (settings.type === 'POST') {
                    xhr.setRequestHeader("RequestVerificationToken",
                        $('input[name="__RequestVerificationToken"]').val());
                }
            }
        });
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>